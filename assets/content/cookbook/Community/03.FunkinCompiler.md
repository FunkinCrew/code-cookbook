[tags]: / "community,tool,hscript"


# Funkin Compiler (VSCode extension)

<div align="center">
    <img src="https://raw.githubusercontent.com/FunkinCompiler/funkin-extension/refs/heads/main/assets/icon.png" alt="Logo" width="200" height="200">
</div>


An extension for Visual Studio Code to provide better tools for making Friday Night Funkin' mods. Most notably, it allows you to use Haxe's Completion Server for type resolving, local code documentation, static code checking, etc.

While it is recommended to create new mods using the built-in command `Funkin compiler: Make new project`, it is possible to use it with existing mods (without the need for migration).

## Setting up

Make sure you have both [Haxe](https://haxe.org/download/) and [Git](https://git-scm.com/) installed.

Then, search for `Funkin Compiler` in the "Extensions" section of VS Code and install it.

Now run the `Funkin Compiler: Setup Funkin compiler` task (You can do so by bringing up the command palette with **Ctrl+Shift+P** and typing in the command). You will be asked for the installation directory for Haxe libraries. Either type it in, or use the folder picker to select an *empty* folder to use.

Now you'll need to wait a couple of minutes for the installation. After it's done, you should see a notification in the bottom-right corner.

## Using Funkin Compiler

The extension can work in two "modes":

- **"Mode 1" (recommended):** Uses the provided mod template to create a comfortable environment for developing mods. Most features included are designed with this mode in mind.

- **"Mode 2":** Lets you open an existing Friday Night Funkin' mod to help with making small changes, or as an alternative to the provided template.

Opening a Funkin Compiler project will enable Mode 1; opening a Friday Night Funkin' mod folder will use Mode 2 instead.

## Using the built-in mod template (Mode 1)

To start, use the `Funkin compiler: Make new project` command to create a new mod project. You will be asked to type in or select a folder for it.

Now let's take a look at the newly opened project. There are a couple of interesting files and directories in it:

- `assets/mod_base`: This folder holds most of your mod's files. In structure, it's exactly the same as any other Friday Night Funkin' mod. However, some assets (like songs and scripts) have their own dedicated directories.

- `assets/fnfc_files`: Here you should put all the songs you want to include with your mod. Simply copy the `.fnfc` files of your songs, and the extension will automatically add them to your mod.

- `source`: Here you can create script files for your mod. This doesn't differ much from writing `.hxc` scripts, but:

  - All scripts must have the `.hx` extension (instead of `.hxc`).

  - Using [Package names](../Expert/02.ModPackages.md) is mandatory.

- `funk.cfg`: This file keeps the information about the paths to the directories we just mentioned. For instance, if you would like to move the song directory from `assets/fnfc_files` to `modSongs`, you would change the `mod_fnfc_folder` value in the config to `modSongs`.

- `checkstyle.json` and `hxformat.json`: These can be used to tweak code formatting, but this article won't go further into that.

Once you're ready to test your mod, press **F5** (or use the "Run and Debug" tab to select the run action) to both compile and launch your mod.

If you haven't done so, you'll be asked to provide a directory with the Friday Night Funkin' instance you want to test your mod with. While it's recommended to use a fresh install of the game, nothing is stopping you from using your active instance.

By default, this will create two mods (and remove their previous copies) in the selected instance: "workbench" and "debug". In addition, your mod will also be placed in the "export" directory of your mod project.

## Editing a standard Friday Night Funkin' mod (Mode 2)

> Please note that this mode is still in development, and as such, not everything will work correctly.

Once you open the mod you want to edit, you might receive a confirmation to apply patches for the vshaxe extension. This patch allows you to edit `.hxc` files as regular Haxe files.

If you want to edit any script files in your mod, change their extension to `.hx`, and after you're done, revert their extension back to `.hxc`.

Due to a quirk with the Haxe Language Server, trying to edit `.hxc` directly will cause some features to stop working.

## Features

> If a feature is exclusive to a specific mode, it will be noted in brackets.

### Hints in .json files

<img width="600" alt="image" src="https://raw.githubusercontent.com/FunkinCompiler/funkin-extension/refs/heads/main/readme-images/jsonc.png" />

Many `.json` files in your mod will get additional type hints, letting you check the syntax and see what you can type into them. Many schemas are also covered by other articles like [Note Styles](../Intermediate/02.CustomNotestyles.md), [Albums](../Intermediate/04.CustomAlbums.md), etc.

### Static code checking

<img width="600" alt="image" src="https://raw.githubusercontent.com/FunkinCompiler/funkin-extension/refs/heads/main/readme-images/staticError.png" />

VS Code will be able to statically check the syntax of your code and detect any misspellings or other typing errors.

#### Object casting

Sometimes, you might know the exact type of a generic object (like the exact type of `ev.targetState`). In those scenarios, you can assume the type like so:

```hx
package mikolka;

// Imports here

class ExampleModule extends Module 
{
  public function new()
  {
    super("test module", 1000);
  }

  override function onStateChangeEnd(ev:StateChangeScriptEvent)
  {
    //* Typical way to check if we're in a desired state
    if (Std.isOfType(ev.targetState, OptionsState))
    {
      //* We know the state's type here
      var setState:OptionsState = cast(ev.targetState, OptionsState);
      //* so we can cast to it here

      // Additional actions on the "setState" value
    }
  }
}

```

Here, we cast `ev.targetState` to `OptionsState` after confirming with `Std.isOfType` that it's actually the state we're looking for.

### Code autocompletion

<img width="600"  alt="image" src="https://raw.githubusercontent.com/FunkinCompiler/funkin-extension/refs/heads/main/readme-images/autocompletion.png" />

When typing, you'll notice this autocompletion window appear from time to time. Using the arrow keys, you can navigate through the different ways to complete the line. You can also continue typing and press "Enter" to complete the line.

### Blacklist detection

<img width="600"  alt="image" src="https://raw.githubusercontent.com/FunkinCompiler/funkin-extension/refs/heads/main/readme-images/blacklist.png" />

The extension will also warn you when importing a known blacklisted class. In most scenarios, trying to import such a class will likely disable the faulty scripted class entirely. You should avoid doing that.

### .FNFC Integration (Mode 1)

As mentioned before, you can auto-integrate songs into your mod using the `fnfc_files` folder. This is useful if you want to keep them for easier editing using the in-game chart editor.

## Customizing the extension

In this section, we will look into technical additions that might be useful for further customization of Funkin Compiler:

### Additions for launch configuration

* `Funk: Compile current V-Slice mod` task (not command): Compiles the currently opened Funkin Compiler project to the FNF instance.
* `Funk: Export current V-Slice mod` task: Same as above, but doesn't copy the mod to the game.
* `Funkin compiler: Make new project` command: As mentioned previously, creates a new Funkin Compiler project.

### Friday Night Funkin' debugger

The `funkin-run-game` debugger is used to launch the game instance. Most notably, it supports soft-restarts (restarting will cause an in-game reload instead of re-opening the game's executable).

It can also be customized with additional configuration options. We'll look at the most important ones:

* `execName`: Name of the executable to launch.
* `attachDebugger`: If enabled, adds the "debug" mod to your instance before starting it.
* `cmd_prefix`: Prefix for the launch command. The only practical use for it is launching a Windows instance of the game using "wine" on Linux.

Here's how you can use them to customize your launch configuration:

```jsonc
{
  "version": "0.2.0",
  "configurations": [
    {
      "type": "funkin-run-game", // Start FNF game
      "request": "launch",
      "name": "Compile & Run FNF mod on V-Slice engine (using wine)",
      "cmd_prefix": "wine ", // Use wine to launch the game
      "execName": "VSliceEngine.exe", // The exact executable name
      "attachDebugger": false, // Don't add the "debug" mod
      "preLaunchTask": "Funk: Compile current V-Slice mod" // Compile and copy the mod to the game
    }
  ]
}

```

### Extension options

These options can be configured using the "Settings UI" under the `Extensions > Funkin Compiler` section:

* `funkinCompiler.modName`: The name of your mod in the game instance. By default, it's "workbench".
* `funkinCompiler.gamePath`: Path to the game folder. (If you remove this path, you'll be asked for it again when launching an FNF instance.)
* `funkinCompiler.haxelibPath`: Path to your haxelib folder. This should be set when running the `Funkin compiler: Setup Funkin compiler` command.

> Author: [Mikolka](https://github.com/mikolka9144)